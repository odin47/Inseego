/* devicemanagement_alarmList 9.12.5 2018-08-27T16:54:01+00:00 b689bea882f7+ (release/9.12.0) tip */
angular.module("c8y.parts.alarmList",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",function(e,t,i){var n="bell",a="alarms",r=i("Overviews");e.addNavigation({parent:r,name:i("Alarms"),priority:2480,icon:n,path:a}),t.when("/alarms",{templateUrl:"devicemanagement_alarmList/views/index.html"}),t.when("/device/:deviceId",{name:i("Alarms"),priority:800,icon:n,templateUrl:"devicemanagement_alarmList/views/index.html"})}]),function(){"use strict";function e(e,t,i,n,a,r,s,l){function c(){h.filter={pageSize:100},h.unresolved=!0,u(),t.deviceId&&(h.filter.source=t.deviceId,h.filter.pageSize=1e3),p.forEach(function(e){b[e]=!0}),v(),o()}function v(){p.forEach(function(e){w[e]=_.assign({},h.filter,{severity:e})})}function o(){r.changeTitle({title:l("Alarms")})}function m(){return t.deviceId?h.unresolved:void 0}function u(){h.filter.resolved=!h.unresolved,v()}function d(){return a({title:l("Confirm clearing alarms?"),body:l("Do you really want to clear all alarms of selected severities?"),status:"danger"}).then(y).then(function(e){var t=e.resolvedImmediately;t?s.success(l("Alarms cleared.")):s.success(l("Alarms are being cleared in background."))}).then(f)}function y(){var e=_.keys(_.pickBy(h.activeSeverities)),t=_.map(e,function(e){var t=_.assign({resolved:!1},_.pick(h.severityFilters[e],["source","severity"])),i={status:n.status.CLEARED};return n.updateBulk(t,i)});return i.all(t).then(function(e){return{resolvedImmediately:_.every(e,function(e){return 200===e.status})}})}function f(){e.$broadcast("alarmListRefresh")}function g(){return _.some(S)}var h=this,p=_.reverse(_.cloneDeep(n.severityList)),b={},w={},S={};_.assign(h,{icon:n.icon,realtime:!0,severities:p,activeSeverities:b,severityFilters:w,refreshingSeverities:S,changeResolved:u,clientSideUnresolved:m,resolveAll:d,refresh:f,isRefreshing:g}),c()}e.$inject=["$scope","$routeParams","$q","c8yAlarms","c8yModal","c8yTitle","c8yAlert","gettext"],angular.module("c8y.parts.alarmList").controller("alarmListCtrl",e)}(),function(){"use strict";function e(e){var t;t='<div ng-controller="alarmListCtrl as vm">\n  <c8y-ui-action-bar-set>\n    <li class="btn-group" action-bar-position="left">\n      <button ng-repeat="severity in vm.severities" type="button" class="btn btn-default" ng-model="vm.activeSeverities[severity]" ng-click="vm.activeSeverities[severity] = !vm.activeSeverities[severity]" ng-class="{\'active\': vm.activeSeverities[severity]}">\n        <i c8y-icon="{{vm.icon(severity)}}" class="status" ng-class="severity | lowercase"></i>\n        <span ng-bind="severity | lowercase | humanize | translate"></span>\n      </button>\n      <!-- @TODO: this is placeholder button to show all alarm types\n      <button type="button" class="btn btn-default">\n        {{\'All\' | translate}}\n      </button>\n      -->\n    </li>\n\n    <li class="navbar-form">\n      <label class="c8y-switch">\n        <input type="checkbox" ng-model="vm.unresolved" ng-change="vm.changeResolved()" ng-true-value="false" ng-false-value="true">\n        <span></span>\n        <p translate>Show cleared alarms</p>\n      </label>\n    </li>\n\n    <li>\n      <button type="button" class="btn btn-link" ng-click="vm.resolveAll()">\n        <i c8y-icon="check-circle"></i> {{\'Clear all\' | translate}}\n      </button>\n    </li>\n\n    <c8y-realtime-switch state="vm.realtime"></c8y-realtime-switch>\n\n    <a href="" class="btn btn-link" title="{{\'Refresh alarm list contents\' | translate}}" ng-click="vm.refresh()">\n      <i c8y-icon="refresh" ng-class="{\'fa-spin\': vm.isRefreshing()}"></i>\n      <span translate>Reload</span>\n    </a>\n  </c8y-ui-action-bar-set>\n\n  <div ng-repeat="severity in vm.severities">\n    <c8y-alarm-list ng-if="vm.activeSeverities[severity]" filter="vm.severityFilters[severity]" realtime="vm.realtime" hide-header-actions="true" data-title="{text:(severity | humanize), icon:vm.icon(severity), class:(severity | lowercase)}" unresolved="vm.clientSideUnresolved()" refresh-loading="vm.refreshingSeverities[severity]">\n    </c8y-alarm-list>\n  </div>\n</div>\n',e.put("alarmList/views/index.html",t),e.put("devicemanagement_alarmList/views/index.html",t),e.put("/apps/devicemanagement/alarmList/views/index.html",t)}angular.module("c8y.parts.alarmList").run(["$templateCache",e])}();