/* cockpit_reports 9.12.5 2018-08-27T16:53:29+00:00 b689bea882f7+ (release/9.12.0) tip */
!function(){"use strict";function t(t,e,r){var n="/reports/:reportId",o={text:r("New report"),action:["c8yReports",function(t){return t.createUI().then(t.save)}],showIfPermissions:{anyRole:["ROLE_INVENTORY_ADMIN","ROLE_INVENTORY_CREATE"]}},i={templateUrl:"cockpit_reports/views/report.html",controller:"ReportsCtrl"};t.addGlobalAction(o),e.when(n,i)}function e(t){t.initialize()}t.$inject=["c8yActionsProvider","c8yViewsProvider","gettext"],e.$inject=["c8yReports"],angular.module("c8y.cockpit.reports",[]).config(t).run(e)}(),function(){"use strict";function t(t,o,i,a,c,l,s){function u(){return a.list(r)}function d(t){return t[e]||(t[e]={}),t}function p(t){d(t);var e=a[t.id?"save":"createConfirm"](t);return t.id?c.findNode(g(t)).update(t):e.then(i.getResData).then(function(t){c.addNavigation(b(t))}),e}function m(){return u().then(h).then(f)}function f(){var t=c.findNode(v);t&&t.update({sortAlphabetically:!0})}function v(t){return"Reports"===t.name}function h(t){c.addNavigation(_.map(t,b))}function b(t){return{report_id:t.id,path:n+t.id,name:t.name,icon:t.icon,parent:{name:s("Reports"),icon:t.icon}}}function g(t){return function(e){return e.report_id===t.id}}function y(t){return R(t).then(_.partial(k,t)).then(_.partial(N,t))}function R(e){var r=c.findNode(g(e));return t.when(c.removeNavigation(r))}function k(t){return l.named(I(t)).then(l.remove)}function N(t){return a.remove(t)}function w(t){var e={templateUrl:"cockpit_reports/views/edit.html",controller:"ReportDetailCtrl",resolve:{report:function(){return t?a.detail(t).then(i.getResData):{}}}};return o.open(e).result}function $(t){return!!t[e]}function I(t){if(!t)throw new Error("Must define a report");return"report_"+(t.id||t)}function C(t){var e=_(t).keys().map(function(t){return _.get(t.match(/^c8y_Dashboard!name!report_(\d+)/),1)}).compact().first();return a.detail(e).then(i.getResData)}return{initialize:m,save:p,list:u,remove:y,detail:a.detail,createUI:w,editUI:w,isReport:$,dashboardName:I,getReportFromDashboard:C}}t.$inject=["$q","$uibModal","c8yBase","c8yInventory","c8yNavigator","dashboardSvc","gettext"],angular.module("c8y.cockpit.reports").factory("c8yReports",t);var e="c8y_Report",r={fragmentType:e,pageSize:1e3},n="reports/"}(),function(){"use strict";function t(t,e,r,n,o,i,a,c){function l(){r.path("/")}function s(){n.detail(m).then(u)}function u(e){var r=e.data;n.isReport(r)&&(t.dashboardName=n.dashboardName(r),t.reportName=r.name)}function d(){return i({title:o("Confirm delete?"),body:c.getString('Do you really want to remove report "{{name}}"?',{name:t.reportName}),labels:{ok:o("Delete")},status:"danger"}).then(angular.bind(n,n.remove,{id:m})).then(l).then(_.partial(a.success,o("Report successfully removed!")))}function p(){return n.editUI(m).then(n.save)}var m=e.reportId;s(),t.removeReport=d,t.editReport=p}t.$inject=["$scope","$routeParams","$location","c8yReports","gettext","c8yModal","c8yAlert","gettextCatalog"],angular.module("c8y.cockpit.reports").controller("ReportsCtrl",t)}(),function(){"use strict";function t(t,e,r,n,o){function i(){e.close(n)}t.title=o(n.id?"Edit report":"Create report"),t.report=n,t.cancel=e.dismiss,t.save=i,t.icons=r}angular.module("c8y.cockpit.reports").controller("ReportDetailCtrl",["$scope","$uibModalInstance","iconList","report","gettext",t])}(),function(){"use strict";function t(t){var e;e='<div class="modal-header">\n  <h3>{{title | translate}}</h3>\n</div>\n\n<div class="modal-body">\n  <form name="reportForm">\n\n    <div class="form-group">\n      <label translate>Name</label>\n      <input class="form-control" name="name" ng-model="report.name" ng-maxlength="512" placeholder="{{\'e.g. My report\' | translate}}" required>\n      <c8y-error-feedback field="reportForm.name">\n      </c8y-error-feedback>\n    </div>\n\n    <div class="form-group">\n      <label translate>Icon</label>\n      <ui-select ng-model="report.icon">\n        <ui-select-match placeholder="{{\'Select or search icon\' | translate}}">\n          <i c8y-icon="{{$select.selected}}"></i> {{$select.selected}}\n        </ui-select-match>\n        <ui-select-choices repeat="item in icons | filter: $select.search">\n          <div>\n            <i c8y-icon="{{item}}"></i> {{item}}\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n  </form>\n\n</div>\n\n<div class="modal-footer">\n  <button class="btn btn-default" ng-click="cancel()" translate>Cancel</button>\n  <button class="btn btn-primary" ng-click="save()" ng-disabled="reportForm.$invalid" translate>Save</button>\n</div>',t.put("reports/views/edit.html",e),t.put("cockpit_reports/views/edit.html",e),t.put("/apps/cockpit/reports/views/edit.html",e),e='<c8y-dashboard-gridstack set-page-title="true" name="{{dashboardName}}" default-children="children">\n  <edit-button>\n    <button title="{{\'Edit report\' | translate}}" class="btn btn-link" ng-click="editReport()">\n      <i c8y-icon="pencil"></i> <translate>Edit</translate>\n    </button>\n  </edit-button>\n  <action-bar-more>\n      <button title="{{\'Remove report\' | translate}}" ng-click="removeReport()">\n        <i c8y-icon="trash"></i> <translate>Remove report</translate>\n      </button>\n  </action-bar-more>\n</c8y-dashboard-gridstack>\n',t.put("reports/views/report.html",e),t.put("cockpit_reports/views/report.html",e),t.put("/apps/cockpit/reports/views/report.html",e)}angular.module("c8y.cockpit.reports").run(["$templateCache",t])}();