/* core_deviceRegistrationSigfoxProvider 9.12.5 2018-08-27T16:54:02+00:00 b689bea882f7+ (release/9.12.0) tip */
!function(){"use strict";function e(e){e.add({name:"sigfox",featureAppName:"sigfox-agent",label:"Sigfox",flow:{single:["sigfox","finish"],multiple:["providers-list","sigfox","finish"]}})}e.$inject=["c8yDeviceProvidersProvider"],angular.module("c8y.deviceRegistrationSigfox",["c8y.deviceRegistration"]).config(e)}(),function(){"use strict";function e(e,t,i,n,r){function c(){e.all([a(),o()]).catch(function(e){return g.errMsg.push(e.data)}).finally(function(){g.providerSettingsLoaded=!0})}function a(){return i.getContracts().then(function(e){g.contracts=_.uniqBy(e,"id"),_.isEmpty(g.contracts)&&s(m)})}function o(){return i.getDeviceTypes().then(function(e){g.deviceTypes=_.uniqBy(e,"id"),_.isEmpty(g.deviceTypes)&&s(u)})}function s(e){g.errMsg.push({message:e})}function l(){n.disableInteractionWhenRequestInProgress(g,!0),n.setFormData(g.wizardCtrl.data,{device:g.device}),i.createNewDeviceRequest(d(g.device)).then(function(e){n.setSuccessData(g.wizardCtrl.data,e),g.wizardCtrl.goTo("finish")}).catch(function(e){n.setErrorData(g.wizardCtrl.data,e),g.wizardCtrl.goTo("finish")}).finally(function(){n.disableInteractionWhenRequestInProgress(g,!1),t(v,500)})}function d(e){var t=_.cloneDeep(e);return _.unset(t,"contract"),_.set(t,"contractId",e.contract.id),_.set(t,"deviceType",_.pick(e.deviceType,["id","name"])),t}function v(){n.doResize()}var g=this,m=r("No contracts available."),u=r("No Sigfox device type configured. Please create one using Device database.");_.assign(g,{$onInit:c,save:l,doResize:v,errMsg:[]})}e.$inject=["$q","$timeout","deviceRegistrationSigfoxProviderService","deviceRegistrationWizardUtils","gettext"],angular.module("c8y.deviceRegistrationSigfox").component("deviceRegistrationSigfox",{require:{wizardCtrl:"^c8yWizardStep"},bindings:{backStep:"@?"},templateUrl:"core_deviceRegistrationSigfoxProvider/deviceRegistrationSigfox.html",controller:e,controllerAs:"vm"})}();var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};!function(){"use strict";function e(e,t,i){function n(){var i=_extends({},o.contracts);return e(i).then(t.getResData)}function r(){return i.getAvailableDeviceTypes({type:"c8y_SigfoxDeviceType"})}function c(i){var n=_extends({},o.newDeviceRequest,{data:i});return e(n).then(t.getResData)}var a=t.url("service/sigfox-agent"),o={contracts:{url:a+"/contract",method:"GET",silentError:!0},newDeviceRequest:{url:a+"/newDeviceRequest",method:"POST",silentError:!0}};return{getContracts:n,getDeviceTypes:r,createNewDeviceRequest:c}}e.$inject=["$http","c8yBase","c8yDeviceDatabase"],angular.module("c8y.deviceRegistrationSigfox").factory("deviceRegistrationSigfoxProviderService",e)}(),function(){"use strict";function e(e){var t;t='<div class="modal-inner-scroll" style="min-height: 225px">\n  <div class="text-center" ng-if="!vm.providerSettingsLoaded && !(vm.contracts.length && vm.deviceTypes.length)" style="margin: 100px 0 50px 0; height: 150px">\n    <i c8y-icon="circle-o-notch" class="fa-spin"></i>\n    <span translate>Wait while provider settings are loaded&hellip;</span>\n  </div>\n  <div ng-form="vm.deviceForm" ng-if="vm.contracts.length && vm.deviceTypes.length" class="modal-body">\n    <div ng-init="vm.doResize()"></div>\n    <div class="form-group">\n      <label translate>ID</label>\n      <input type="text" name="id" class="form-control" ng-model="vm.device.id" placeholder="{{\'e.g.\' | translate}} FED987" required>\n      <c8y-error-feedback field="vm.deviceForm.id"></c8y-error-feedback>\n    </div>\n    <div class="form-group">\n      <label translate>PAC</label>\n      <input type="text" name="pac" class="form-control" ng-model="vm.device.pac" placeholder="{{\'e.g.\' | translate}} FEDCBA9876543210" required>\n      <c8y-error-feedback field="vm.deviceForm.pac"></c8y-error-feedback>\n    </div>\n    <div class="form-group">\n      <label translate>Contract</label>\n      <ui-select name="contract" class="form-control text-left" ng-model="vm.device.contract" required>\n        <ui-select-match placeholder="{{\'Select contract\' | translate}}">\n          {{vm.device.contract.name}}\n        </ui-select-match>\n        <ui-select-choices repeat="contract in vm.contracts | filter: $select.search track by contract.id | orderBy:\'name\'">\n          <span ng-bind-html="contract.name | highlight: $select.search" title="{{contract.name}}"></span>\n        </ui-select-choices>\n      </ui-select>\n      <c8y-error-feedback field="vm.deviceForm.contract"></c8y-error-feedback>\n    </div>\n    <div class="form-group">\n      <label translate>Device type</label>\n      <ui-select name="type" class="form-control text-left" ng-model="vm.device.deviceType" required>\n        <ui-select-match placeholder="{{\'Select device type\'| translate}}">\n          {{vm.device.deviceType.name}}\n        </ui-select-match>\n        <ui-select-choices repeat="deviceType in vm.deviceTypes | filter: $select.search track by deviceType.id | orderBy:\'name\'">\n          <span ng-bind-html="deviceType.name | highlight: $select.search" title="{{deviceType.name}}"></span>\n        </ui-select-choices>\n      </ui-select>\n      <c8y-error-feedback field="vm.deviceForm.type"></c8y-error-feedback>\n    </div>\n    <div class="form-group">\n      <label translate>Product certificate key</label>\n      <input type="text" name="productCertificate" class="form-control" ng-model="vm.device.productCertificate" placeholder="{{\'e.g.\' | translate}} P_001F_EDCB_012" required>\n      <c8y-error-feedback field="vm.deviceForm.productCertificate"></c8y-error-feedback>\n    </div>\n  </div>\n  <div class="alert alert-danger" ng-if="vm.providerSettingsLoaded && !(vm.contracts.length && vm.deviceTypes.length)" style="margin: 15px">\n    <div ng-repeat="msg in vm.errMsg">\n      <span>{{msg.message | translateServerMessage}}</span>\n    </div>\n  </div>\n  <div class="c8y-wizard-footer">\n    <button class="btn btn-default" ng-click="vm.wizardCtrl.goTo(vm.backStep)" ng-disabled="vm.inProgress" translate>\n      Back\n    </button>\n    <button class="btn btn-primary" ng-click="vm.save()" ng-disabled="vm.deviceForm.$invalid || vm.errMsg.length || vm.inProgress">\n      <span ng-show="!vm.inProgress" translate>Next</span>\n      <span ng-show="vm.inProgress">\n        <i c8y-icon="circle-o-notch" class="fa-spin"></i>\n      </span>\n    </button>\n  </div>\n</div>\n',e.put("deviceRegistrationSigfoxProvider/deviceRegistrationSigfox.html",t),e.put("core_deviceRegistrationSigfoxProvider/deviceRegistrationSigfox.html",t),e.put("/apps/core/deviceRegistrationSigfoxProvider/deviceRegistrationSigfox.html",t)}angular.module("c8y.deviceRegistrationSigfox").run(["$templateCache",e])}();